vzxm24576 ;convert pic from ZX multiColor 24576 .mcx            call    readfile2n ;считаем первые 64 сектора            call    vzxm24576p ;пиксели            ;теперь атрибуты            call    vzxm24576a						;второй экран			ld      a,(curpicpag)            inc     a			ld 		(curpicpag),a			call    pag_on						ld		hl,loadadr2+12288			ld		de,#c000			ld		bc,#1000			ldir			call    readfile2n ;считаем остаток			;сдвинем вверх			ld		hl,loadadr2+256+#2000			ld		de,loadadr2+#1000+#2000			ld		bc,#2000			lddr						ld		hl,#c000 ;обратно кусок картинки			ld		de,loadadr2			ld		bc,#1000			ldir						;сконвертируем остаток			; ld      a,(curpicpag)            ; inc     a			; ld 		(curpicpag),a			; call    pag_on			            call    vzxm24576p ;пиксели            ;теперь атрибуты            call    vzxm24576a            ;коррекция числа страниц            ld      a,4 ;             ld      (allpicpag),a ; всего страниц            call    showpicFlic ;показать картинку            xor     a            call    pag_on            call    gmxpagoff			ld		a,1 ;флаг что картинка с двумя экранами			ld		(FlagFlic),a            retvzxm24576p ;convert pixel            ;call    readfile2n ;считаем первые 64 сектора или весь файл, если он меньше            call    clearpag            ld      a,8 ;оступ            ld      (shiftL),a            ld      (shiftR),a            ld      a,32            ld      (hsize),a            ld      hl,loadadr2 ;откуда            ld      de,#c000+320 ;левый верхний            ld      b,192 ;строкvzxm24576p_0            push    bc            ex 		de,hl            ld      bc,(shiftL)            add     hl,bc            ex 		de,hl           ; push    hl            ld      a,(hsize)            ld      b,a                ;перенос строкиvzxm24576p_3			call stretchPix ;удвоить пиксели по ширине				            inc     hl            inc     de            dec     b ;закрываем цикл столбцов            jp      nz,vzxm24576p_3			ex 		de,hl            ld      bc,(shiftR)            add     hl,bc			ex 		de,hl			pop	bc ;закрываем цикл строк			dec b			jp      nz,vzxm24576p_0            retvzxm24576a ;convert atr             ;теперь атрибуты            ld      a,(curpicpag)            inc     a			ld 		(curpicpag),a            call    pag_on            ld      hl,loadadr2+6144 ;откуда            ld      de,#c000+320 ;левый верхний            ld      b,192  ;цикл строкvzxm24576a3            push    bc			ex 		de,hl            ld      bc,(shiftL)            add     hl,bc			ex 		de,hl            ;push    hl            ld      b,32  ;столбцовvzxm24576a1            ld      a,(hl)            ld      (de),a            inc     de            ld      (de),a            inc     hl            inc     de            djnz    vzxm24576a1 			ex 		de,hl            ld      bc,(shiftR)            add     hl,bc			ex 		de,hl            ;ld      bc,32            ;add     hl,bc            pop     bc            djnz    vzxm24576a3            ret